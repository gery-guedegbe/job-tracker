name: Preview Build on PR

# ============================================================================
# WORKFLOW POUR LES PULL REQUESTS
# ============================================================================
# Ã€ chaque PR, on crÃ©e un build preview (sans dÃ©ployer)
# C'est utile pour vÃ©rifier que le build passe avant merge
#
# ============================================================================

on:
    pull_request:
        branches: [main]

jobs:
    preview-build:
        name: ğŸ”¨ Build Preview
        runs-on: ubuntu-latest
        timeout-minutes: 15

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Setup Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: "20.x"
                  cache: "npm"

            - name: Install dependencies
              run: npm ci

            - name: ğŸ” ESLint check
              run: npm run lint

            - name: ğŸ§ª Run tests
              run: npm run test:run

            - name: ğŸ“ TypeScript check
              run: npx tsc --noEmit

            - name: ğŸ—ï¸ Build preview
              run: npm run build

            - name: ğŸ“¦ Upload build artifact
              uses: actions/upload-artifact@v4
              with:
                  name: preview-build
                  path: dist/
                  retention-days: 3

            - name: âœ… Preview build successful
              run: echo "âœ… Build passed! Ready to merge."
# ============================================================================
# NOTES
# ============================================================================
# Ce workflow :
# - S'exÃ©cute sur CHAQUE pull request vers main
# - Valide le code (lint, tests, types)
# - Build le code
# - Upload l'artifact du build pour inspection
#
# Si tous les checks passent â†’ âœ… SÃ»r de merger
# Si un check Ã©choue â†’ âŒ Fixer avant merge
#
# ============================================================================
