name: CI/CD Pipeline (Simple)

# ============================================================================
# VERSION SIMPLIFI√âE SANS VERCEL
# ============================================================================
# Utilisez ce fichier si vous ne voulez pas configurer Vercel pour l'instant.
# Sinon, utilisez ci.yml (avec deployment Vercel).
#
# Ce workflow v√©rifie juste :
# - ESLint (code quality)
# - Vitest (unit tests)
# - TypeScript (type safety)
# - Production build (no errors)
#
# ============================================================================

on:
    push:
        branches: [main]
    pull_request:
        branches: [main]

env:
    NODE_VERSION: "20.x"

jobs:
    # ==========================================================================
    # JOB 1 : Code Quality & Tests
    # ==========================================================================
    quality-and-tests:
        name: ‚ú® Code Quality & Tests
        runs-on: ubuntu-latest
        timeout-minutes: 15

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Setup Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: ${{ env.NODE_VERSION }}
                  cache: "npm"

            - name: Install dependencies
              run: npm ci

            - name: üîç Lint with ESLint
              run: npm run lint

            - name: üß™ Run tests with Vitest
              run: npm run test:run

            - name: üìù TypeScript type check
              run: npx tsc --noEmit

    # ==========================================================================
    # JOB 2 : Production Build
    # ==========================================================================
    build:
        name: üèóÔ∏è Build for Production
        runs-on: ubuntu-latest
        timeout-minutes: 15
        needs: quality-and-tests
        # Seulement si les tests passent

        steps:
            - name: Checkout code
              uses: actions/checkout@v4

            - name: Setup Node.js
              uses: actions/setup-node@v4
              with:
                  node-version: ${{ env.NODE_VERSION }}
                  cache: "npm"

            - name: Install dependencies
              run: npm ci

            - name: Build with Vite
              run: npm run build

            - name: ‚úÖ Build successful
              run: echo "Production build completed successfully!"
# ============================================================================
# STATUT BADGES
# ============================================================================
# Ajouter ce badge dans README.md :
#
# [![CI/CD](https://github.com/gery-guedegbe/job-tracker/actions/workflows/ci-simple.yml/badge.svg)](https://github.com/gery-guedegbe/job-tracker/actions)
#
# ============================================================================
